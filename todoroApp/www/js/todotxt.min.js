var TodoTxt=function(){var r="asc",n="desc",c=/^\s+|\s+$/g,l=/\s+/,a=/^\d{4}$/,o=/^\d{2}$/,v=/^\([A-Z]\)$/,u=/^\s*$/,s=/[^\:]+\:[^\:]/,y=function(t){for(var h,c=function(n){for(var t=0;t<e.length;t++)if(e[t].id()===n.id())return t+1;return 0},l=t.split("\n"),e=[],o={},s=0;s<l.length;s++)(h=l[s],u.test(h))||e.push(f(h,c));return o.render=function(n,t){for(var u=o.items(n,t),i="",r=0;r<u.length;r++)i!==""&&(i+="\n"),i+=u[r].render();return i},o.items=function(t,u){var s=[],h,o,f,l;for(t||(t={}),o=0;o<e.length;o++)h=e[o],p(h,t)&&s.push(h);if(i(u)){for(o=0;o<u.length;o++){if(f=u[o],typeof f=="string"&&(u[o]=f={field:f,direction:r}),!f.field)throw new Error("Invalid sort "+f);if(l=["priority","createdDate","completedDate","isComplete","lineNumber"],l.indexOf(f.field)===-1)throw new Error("Cannot sort by this field: "+f.field);f.direction!==n&&(f.direction=r)}var c=null,a=function(t,i,r){var u=t[r.field](),f=i[r.field]();return function(){if(u===f)return 0;switch(r.field){case"isComplete":return r.direction===n?u?1:-1:u?-1:1;case"createdDate":case"completedDate":return u===null?1:f===null?-1:u.getTime()===f.getTime()?0:r.direction===n?u<f?1:-1:u<f?-1:1;case"priority":return u===null?r.direction===n?-1:1:f===null?r.direction===n?1:-1:r.direction===n?u<f?1:-1:u<f?-1:1;default:throw new Error("Unhandled sort.field "+r.field);}}()},v=function(t,i){var r,f,e;try{for(r=0;r<u.length;r++){if(u[r].field==="lineNumber")return f=u[r].direction===n,t.lineNumber()===i.lineNumber()?0:t.lineNumber()<i.lineNumber()?f?1:-1:f?-1:1;if(e=a(t,i,u[r]),e!==0)return e}}catch(o){return c=o,0}return t.lineNumber()<i.lineNumber()?-1:1};if(s.sort(v),c)throw new Error(c);}return s},o.length=e.length,o.removeItem=function(n,t){var r,u,i;for(typeof n.render=="function"&&(n=n.render()),r=[],i=0;i<e.length;i++)r[i]=e[i];for(u=0,i=0;i<r.length;i++)if(r[i].render()===n){if(e.splice(u,1),!t)break}else u++;o.length=e.length},o.addItem=function(n){return typeof n.render=="function"&&(n=n.render()),n=f(n,c),n.createdDate()||n.setCreatedDate(new Date),e.push(n),o.length=e.length,n},o.collections=function(n){for(var u={},f={},o=[],s=[],t,r,h,c,i=0;i<e.length;i++)if(n||!e[i].isComplete()){for(h=e[i].contexts(),c=e[i].projects(),t=0;t<h.length;t++)u[h[t]]=!0;for(t=0;t<c.length;t++)f[c[t]]=!0}for(r in u)u[r]===!0&&o.push(r);for(r in f)f[r]===!0&&s.push(r);return o.sort(),s.sort(),{contexts:o,projects:s}},o},p=function(n,r){var e,s,c,h;for(e in r)if(r.hasOwnProperty(e)){if(!n.hasOwnProperty(e))throw new Error("This property is invalid for query: "+e);var u=r[e],f=n[e](),o="direct";typeof u=="function"?o="function":i(u)&&(o="containsAll");switch(o){case"function":if(!u(f))return!1;break;case"containsAll":if(!i(f))throw new Error("Cannot pass array for non-array property");for(s=0;s<u.length;s++){for(c=!1,h=0;h<f.length;h++)if(u[s]===f[h]){c=!0;break}if(!c)return!1}break;case"direct":if(t(u)&&t(f))return w(u,f);if(u!==f)return!1;break;default:throw new Error("unexpected queryPropType: "+o);}}return!0},f=function(n,r){var y,w=function(t){n=t.replace(c,"");y=[];n!==""&&(y=n.split(l))},k,f;if(!n||u.test(n))return null;w(n);k="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});f={};f.render=function(){return y.join(" ")};f.replaceWith=function(n){if(!n||u.test(n))throw new Error("Cannot replace a line with nothing.");w(n)};f.id=function(){return k};f.isComplete=function(){return y.length>0&&y[0]==="x"};f.completedDate=function(){return f.isComplete()?y.length<2?null:g(y[1]):null};f.priority=function(){var n=0,t;return(f.isComplete()&&(n++,f.completedDate()&&n++),y.length<=n)?null:(t=y[n],!v.test(t))?null:t[1]};f.createdDate=function(){var n=0,t;return(f.isComplete()&&n++,f.completedDate()&&n++,f.priority()&&n++,y.length<=n)?null:(t=y[n],g(t))};f.contexts=function(){for(var n,i={},t=0;t<y.length;t++)(n=y[t],n.length<2)||n[0]==="@"&&(i[n]=!0);return h(i,"boolean")};f.projects=function(){for(var n,i={},t=0;t<y.length;t++)(n=y[t],n.length<2)||n[0]==="+"&&(i[n]=!0);return h(i,"boolean")};f.addons=function(){for(var u,o,n={},r=0;r<y.length;r++)if(u=y[r],s.test(u)){var e=u.split(":"),h=e.splice(1),t=e[0],f=h.join(":");n[t]?i(n[t])?n[t].push(f):(o=n[t],n[t]=[o,f]):n[t]=f}return n};f.textTokens=function(){var r=[],n=0,i,t;for(f.isComplete()&&n++,f.completedDate()&&n++,f.priority()&&n++,f.createdDate()&&n++,i=n;i<y.length;i++)(t=y[i],t[0]==="@"||t[0]==="+"||s.test(t))||r.push(t);return r};f.lineNumber=function(){return r(this)};f.completeTask=function(){f.isComplete()||y.splice(0,0,"x",e())};f.uncompleteTask=function(){if(f.isComplete()){var n=1;t(f.completedDate())&&n++;y.splice(0,n)}};f.setCreatedDate=function(n){t(n)||(n=new Date);n=b(n);var i=0,r=f.createdDate()===null;f.priority()&&i++;f.completedDate()&&i++;f.isComplete()&&i++;y.splice(i,r?0:1,e(n))};f.addContext=function(n){var i,t;if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid context: "+n);for(n[0]!=="@"&&(n="@"+n),i=f.contexts(),t=0;t<i.length;t++)if(i[t]===n)return;y.push(n)};f.addProject=function(n){var i,t;if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid project: "+n);for(n[0]!=="+"&&(n="+"+n),i=f.projects(),t=0;t<i.length;t++)if(i[t]===n)return;y.push(n)};f.removeContext=function(n){if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid context: "+n);n[0]!=="@"&&(n="@"+n);p(n)};f.removeProject=function(n){if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid project: "+n);n[0]!=="+"&&(n="+"+n);p(n)};f.setAddOn=function(n,i){var u,f,r,o;if(typeof n!="string"||/^\s*$/.test(n)||["@","+"].indexOf(n[0])>-1)throw new Error("Invalid addon name: "+n);for(i=t(i)?e(i):i.toString(),f=null,r=d(y,function(t){return t.substr(0,n.length+1)===n+":"}),r.length>0&&(f=r[0],r.splice(0,1)),r.reverse(),u=0;u<r.length;u++)y.splice(r[u],1);o=n+":"+i;f===null?y.push(o):y.splice(f,1,o)};f.removeAddOn=function(n){if(typeof n!="string"||/^\s*$/.test(n)||["@","+"].indexOf(n[0])>-1)throw new Error("Invalid addon name: "+n);p(function(t){return t.substr(0,n.length+1)===n+":"})};var d=function(n,t){var u,r,i;for(typeof t!="function"&&(u=t.toString(),t=function(n){return n===u}),r=[],i=0;i<n.length;i++)t(n[i])&&r.push(i);return r},p=function(n){var i=d(y,n),t;for(i.reverse(),t=0;t<i.length;t++)y.splice(i[t],1)},g=function(n){var i=n.split("-"),e,t;if(i.length!==3)return null;var r=i[0],u=i[1],f=i[2],s=a.test(r)&&o.test(u)&&o.test(f);return s?(e=i.join("/"),t=new Date(e),t.toString()==="Invalid Date")?null:(r=parseInt(r,10),u=parseInt(u,10),f=parseInt(f,10),t.getFullYear()!==r)?null:t.getMonth()!==u-1?null:t.getDate()!==f?null:t:null};return f},e=function(n){t(n)||(n=new Date);var i=function(n,t){for(var i=n.toString();i.length<t;)i="0"+i;return i};return n.getFullYear()+"-"+i(n.getMonth()+1,2)+"-"+i(n.getDate(),2)},i=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},t=function(n){return n&&typeof n=="object"&&toString.call(n)=="[object Date]"||!1},w=function(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},b=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},h=function(n,t){var r=[];for(var i in n)n.hasOwnProperty(i)&&(t&&typeof n[i]!==t||r.push(i));return r};return{SORT_ASC:r,SORT_DESC:n,parseFile:y,parseLine:function(n){return f(n,0)}}}();
/*
//# sourceMappingURL=todotxt.min.js.map
*/